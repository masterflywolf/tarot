import{_ as e,W as a,g as t,Z as i,M as s,aN as r,N as l,o,c as n,w as d,f as u,d as f,a as m,e as c,t as y,C as p,F as h,q as g,O as C,v,P as _,D as F,a4 as N,i as I}from"./index-6d8df4d2.js";import{_ as k}from"./uni-easyinput.b407beea.js";import{_ as x}from"./uni-forms-item.5a5358a6.js";import{_ as b}from"./uni-forms.8754e8fd.js";import{_ as j}from"./uni-id-pages-agreements.20f1e757.js";import{m as A}from"./login-page.mixin.9bb84df6.js";import{s as V,m as T}from"./store.682ebf55.js";import"./uni-popup-dialog.aa82751c.js";import"./uni-popup.4ce3ad51.js";a.importObject("uni-id-co");const O=e({mixins:[A],data:()=>({realName:"",idCard:"",certifyId:"",verifyFail:!1,verifyFailCode:0,verifyFailTitle:"",verifyFailContent:""}),computed:{userInfo:()=>V.userInfo,certifyIdNext(){return Boolean(this.realName)&&Boolean(this.idCard)&&this.needAgreements&&this.agree},isCertify(){return this.userInfo.realNameAuth&&2===this.userInfo.realNameAuth.authStatus},isDev:()=>!1},onLoad(){const e=t("uni-id-pages-temp-frv");e&&(this.realName=e.realName,this.idCard=e.idCard)},methods:{async getCertifyId(){if(this.certifyIdNext)return i({content:"暂不支持实名认证",showCancel:!1})},startFacialRecognitionVerify(){},async getFrvAuthResult(){const e=a.importObject("uni-id-co",{customUI:!0});try{s({title:"验证中...",mask:!1});const a=await e.getFrvAuthResult({certifyId:this.certifyId}),{errCode:t,...o}=a;this.verifyFailContent&&console.log(`[frv-debug] 客户端刷脸失败，由实人认证服务查询具体原因，原因：${this.verifyFailContent}`),i({content:"实名认证成功",showCancel:!1,success:()=>{T.setUserInfo({realNameAuth:o}),this.verifyFail=!1}}),r({key:"uni-id-pages-temp-frv"})}catch(t){this.verifyFail=!0,this.verifyFailTitle=t.errMsg,console.error(JSON.stringify(t))}finally{l()}},retry(){10013!==this.verifyFailCode?this.getCertifyId():this.verifyFail=!1}}},[["render",function(e,a,t,i,s,r){const l=g(v("uni-list-item"),C),A=g(v("uni-list"),_),V=F,T=u,O=N,w=I,D=g(v("uni-easyinput"),k),U=g(v("uni-forms-item"),x),R=g(v("uni-forms"),b),B=g(v("uni-id-pages-agreements"),j);return o(),n(T,null,{default:d((()=>[r.isCertify?(o(),n(A,{key:0},{default:d((()=>[f(l,{class:"item",title:"姓名",rightText:r.userInfo.realNameAuth.realName},null,8,["rightText"]),f(l,{class:"item",title:"身份证号码",rightText:r.userInfo.realNameAuth.identity},null,8,["rightText"])])),_:1})):(o(),n(T,{key:1,class:"uni-content"},{default:d((()=>[s.verifyFail?(o(),m(h,{key:0},[f(T,{class:"face-icon"},{default:d((()=>[f(V,{src:"/assets/face-verify-icon-da277dd7.svg",class:"face-icon-image"})])),_:1}),f(T,{class:"error-title"},{default:d((()=>[c(y(s.verifyFailTitle),1)])),_:1}),f(T,{class:"error-description"},{default:d((()=>[c(y(s.verifyFailContent),1)])),_:1}),10013!==s.verifyFailCode?(o(),n(O,{key:0,type:"primary",onClick:r.retry},{default:d((()=>[c("重新开始验证")])),_:1},8,["onClick"])):(o(),n(O,{key:1,type:"primary",onClick:r.retry},{default:d((()=>[c("返回")])),_:1},8,["onClick"])),r.isDev?(o(),n(T,{key:2,class:"dev-tip"},{default:d((()=>[c("请在控制台查看详细错误（此提示仅在开发环境展示）")])),_:1})):p("",!0)],64)):(o(),m(h,{key:1},[f(w,{class:"title"},{default:d((()=>[c("实名认证")])),_:1}),f(R,null,{default:d((()=>[f(U,{name:"realName"},{default:d((()=>[f(D,{placeholder:"姓名",class:"input-box",modelValue:s.realName,"onUpdate:modelValue":a[0]||(a[0]=e=>s.realName=e),clearable:!1},null,8,["modelValue"])])),_:1}),f(U,{name:"idCard"},{default:d((()=>[f(D,{placeholder:"身份证号码",class:"input-box",modelValue:s.idCard,"onUpdate:modelValue":a[1]||(a[1]=e=>s.idCard=e),clearable:!1},null,8,["modelValue"])])),_:1})])),_:1}),f(B,{scope:"realNameVerify",ref:"agreements",style:{"margin-bottom":"20px"}},null,512),f(O,{type:"primary",disabled:!r.certifyIdNext,onClick:r.getCertifyId},{default:d((()=>[c("确定")])),_:1},8,["disabled","onClick"])],64))])),_:1}))])),_:1})}],["__scopeId","data-v-6b998579"]]);export{O as default};
